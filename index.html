<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Studio Pro | Ultimate Edition 2026</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>
    
    <style>
        :root {
            --primary: #6366f1;
            --secondary: #f43f5e;
            --accent: #10b981;
            --bg: #030712;
            --card: rgba(17, 24, 39, 0.9);
            --border: rgba(255, 255, 255, 0.1);
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background: var(--bg);
            color: #f9fafb; margin: 0; min-height: 100vh;
            background-image: radial-gradient(circle at 50% 50%, rgba(99, 102, 241, 0.1), transparent);
        }

        /* Navbar */
        nav {
            padding: 1.2rem 5%; display: flex; justify-content: space-between; align-items: center;
            backdrop-filter: blur(20px); border-bottom: 1px solid var(--border);
            position: sticky; top: 0; z-index: 1000;
        }

        .brand-logo { display: flex; align-items: center; gap: 15px; font-weight: 900; font-size: 1.8rem; }
        .logo-glyph { background: linear-gradient(135deg, var(--primary), var(--secondary)); width: 45px; height: 45px; border-radius: 14px; display: grid; place-items: center; box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4); }

        /* Main Layout */
        .dashboard {
            max-width: 1440px; margin: 2rem auto; display: grid; grid-template-columns: 420px 1fr; gap: 2.5rem; padding: 0 2rem;
        }

        @media (max-width: 1100px) { .dashboard { grid-template-columns: 1fr; } }

        /* Controls Sidebar */
        .settings-panel {
            display: flex; flex-direction: column; gap: 1.5rem; max-height: 85vh; overflow-y: auto; padding-right: 5px;
        }
        .settings-panel::-webkit-scrollbar { width: 4px; }
        .settings-panel::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 10px; }

        .widget { background: var(--card); border: 1px solid var(--border); border-radius: 30px; padding: 1.8rem; }
        .widget-title { font-size: 0.8rem; font-weight: 800; color: #6b7280; text-transform: uppercase; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 10px; }
        .widget-title::after { content: ''; flex: 1; height: 1px; background: var(--border); }

        /* Inputs & Selects */
        .input-box { width: 100%; background: #000; border: 1px solid var(--border); border-radius: 15px; padding: 15px; color: white; font-family: inherit; margin-bottom: 1rem; }
        .input-box:focus { border-color: var(--primary); outline: none; }

        .preset-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 1rem; }
        .preset-btn { background: rgba(255,255,255,0.05); border: 1px solid var(--border); border-radius: 12px; padding: 10px; font-size: 0.75rem; color: white; cursor: pointer; }
        .preset-btn:hover { border-color: var(--primary); background: rgba(99,102,241,0.1); }

        /* Preview Canvas */
        .preview-area { display: flex; flex-direction: column; align-items: center; justify-content: flex-start; }
        
        #capture-node {
            background: #ffffff; padding: 60px; border-radius: 50px; text-align: center;
            box-shadow: 0 50px 100px rgba(0,0,0,0.6); border: 15px solid #f8fafc;
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #capture-node.transparent { background: transparent !important; border-color: var(--primary) !important; box-shadow: none; }

        .custom-label {
            margin-top: 25px; font-weight: 900; font-size: 1.8rem; color: #0f172a; 
            line-height: 1.2; direction: rtl;
        }

        /* Quality Indicator */
        .score-card { background: rgba(16, 185, 129, 0.1); border: 1px solid var(--accent); border-radius: 100px; padding: 8px 20px; font-size: 0.8rem; color: var(--accent); margin-bottom: 2rem; }

        /* Export Bar */
        .export-bar { margin-top: 3rem; display: flex; flex-direction: column; gap: 1rem; width: 100%; max-width: 500px; }
        .download-btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white; border: none; padding: 22px; border-radius: 20px; font-weight: 900; font-size: 1.2rem; cursor: pointer;
            box-shadow: 0 15px 30px rgba(244, 63, 94, 0.3);
        }
        .download-btn:hover { transform: scale(1.02); }

    </style>
</head>
<body>

<nav>
    <div class="brand-logo">
        <div class="logo-glyph">QR</div>
        <span>STUDIO <span style="color: var(--secondary)">ULTIMATE</span></span>
    </div>
    <div class="score-card" id="scan-score">â— Ø¬ÙˆØ¯Ø© Ø§Ù„ÙƒÙˆØ¯: Ù…Ø«Ø§Ù„ÙŠØ© Ù„Ù„Ù…Ø³Ø­</div>
</nav>

<main class="dashboard">
    <aside class="settings-panel">
        <div class="widget">
            <div class="widget-title">1. Ù‚ÙˆØ§Ù„Ø¨ Ø³Ø±ÙŠØ¹Ø© (Presets)</div>
            <div class="preset-grid">
                <button class="preset-btn" onclick="applyPreset('#6366f1', '#ec4899', 'extra-rounded')">Ù…ÙˆØ¯Ø±Ù†</button>
                <button class="preset-btn" onclick="applyPreset('#10b981', '#059669', 'square')">Ø·Ø¨ÙŠ</button>
                <button class="preset-btn" onclick="applyPreset('#f59e0b', '#d97706', 'dots')">Ø°Ù‡Ø¨ÙŠ</button>
            </div>

            <div class="widget-title">2. Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆØ§Ù„Ù†Øµ</div>
            <input type="text" id="qr-data" class="input-box" placeholder="Ø§Ù„Ø±Ø§Ø¨Ø· (URL)" oninput="sync()">
            <input type="text" id="qr-text" class="input-box" placeholder="Ø§Ù„Ù†Øµ ØªØ­Øª Ø§Ù„ÙƒÙˆØ¯ (Ù…Ø«Ù„Ø§Ù‹: Ø§Ù…Ø³Ø­Ù†ÙŠ)" oninput="sync()">
        </div>

        <div class="widget">
            <div class="widget-title">3. Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¨ØµØ±ÙŠØ©</div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <div>
                    <label style="font-size: 0.7rem; color: #6b7280;">Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</label>
                    <input type="color" id="c1" value="#6366f1" oninput="sync()" style="width:100%; height:40px; border:none; background:none; cursor:pointer;">
                </div>
                <div>
                    <label style="font-size: 0.7rem; color: #6b7280;">Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</label>
                    <input type="color" id="c2" value="#f43f5e" oninput="sync()" style="width:100%; height:40px; border:none; background:none; cursor:pointer;">
                </div>
            </div>

            <div style="margin-top: 1.5rem;">
                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                    <input type="checkbox" id="trans-toggle" onchange="sync()" style="width: 22px; height: 22px; accent-color: var(--primary);">
                    <span style="font-weight: 700;">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø´ÙØ§ÙÙŠØ© Ø§Ù„Ù…Ø·Ù„Ù‚Ø©</span>
                </label>
            </div>
        </div>

        <div class="widget">
            <div class="widget-title">4. Ù…ØªÙ‚Ø¯Ù…</div>
            <select id="dot-style" class="input-box" onchange="sync()">
                <option value="extra-rounded">Ù†Ù‚Ø§Ø· Ø¯Ø§Ø¦Ø±ÙŠØ©</option>
                <option value="square">Ù…Ø±Ø¨Ø¹Ø§Øª</option>
                <option value="classy">ÙƒÙ„Ø§Ø³ÙŠÙƒ</option>
            </select>
            <input type="file" id="logo-in" class="input-box" onchange="sync()" style="font-size: 0.8rem;">
        </div>
    </aside>

    <section class="preview-area">
        <div id="capture-node">
            <div id="canvas-target"></div>
            <div id="label-target" class="custom-label">Ø§Ù…Ø³Ø­ Ø§Ù„ÙƒÙˆØ¯</div>
        </div>

        <div class="export-bar">
            <button class="download-btn" onclick="takeSnapshot()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ (PNG HD)</button>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <button class="preset-btn" style="padding: 15px;" onclick="rawDown('svg')">ØªØ­Ù…ÙŠÙ„ ÙƒÙ…Ù„Ù SVG</button>
                <button class="preset-btn" style="padding: 15px;" onclick="rawDown('pdf')">ØªØ­Ù…ÙŠÙ„ ÙƒÙ…Ù„Ù PDF</button>
            </div>
        </div>
    </section>
</main>

<script>
    const qrModel = new QRCodeStyling({
        width: 320, height: 320,
        dotsOptions: { type: "extra-rounded", gradient: { type: "linear", colorStops: [{ offset: 0, color: "#6366f1" }, { offset: 1, color: "#f43f5e" }] } },
        backgroundOptions: { color: "#ffffff" },
        cornersSquareOptions: { type: "extra-rounded" }
    });

    qrModel.append(document.getElementById("canvas-target"));

    function applyPreset(col1, col2, style) {
        document.getElementById('c1').value = col1;
        document.getElementById('c2').value = col2;
        document.getElementById('dot-style').value = style;
        sync();
    }

    function sync() {
        const data = document.getElementById('qr-data').value || "https://google.com";
        const text = document.getElementById('qr-text').value || "Ø§Ù…Ø³Ø­ Ø§Ù„ÙƒÙˆØ¯";
        const col1 = document.getElementById('c1').value;
        const col2 = document.getElementById('c2').value;
        const isTrans = document.getElementById('trans-toggle').checked;
        const style = document.getElementById('dot-style').value;
        const logo = document.getElementById('logo-in').files[0];

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        const node = document.getElementById('capture-node');
        const label = document.getElementById('label-target');
        
        label.innerText = text;
        
        if(isTrans) {
            node.classList.add('transparent');
            label.style.color = col1;
        } else {
            node.classList.remove('transparent');
            label.style.color = "#0f172a";
            node.style.borderColor = col1;
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù€ QR
        qrModel.update({
            data: data,
            dotsOptions: { type: style, gradient: { type: "linear", colorStops: [{ offset: 0, color: col1 }, { offset: 1, color: col2 }] } },
            backgroundOptions: { color: isTrans ? "transparent" : "#ffffff" },
            cornersSquareOptions: { color: col1 }
        });

        if (logo) {
            const reader = new FileReader();
            reader.onload = (e) => qrModel.update({ image: e.target.result });
            reader.readAsDataURL(logo);
        }

        // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¬ÙˆØ¯Ø© (Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø·ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª)
        const score = document.getElementById('scan-score');
        if(data.length > 150) {
            score.innerText = "â— Ø§Ù„Ø¬ÙˆØ¯Ø©: Ù…ØªÙˆØ³Ø·Ø© (Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ«ÙŠØ±Ø©)";
            score.style.color = "#f59e0b";
            score.style.borderColor = "#f59e0b";
        } else {
            score.innerText = "â— Ø¬ÙˆØ¯Ø© Ø§Ù„ÙƒÙˆØ¯: Ù…Ø«Ø§Ù„ÙŠØ© Ù„Ù„Ù…Ø³Ø­";
            score.style.color = "#10b981";
            score.style.borderColor = "#10b981";
        }
    }

    async function takeSnapshot() {
        const node = document.getElementById('capture-node');
        const scale = 4; // Ø¯Ù‚Ø© Ø¬Ø¨Ø§Ø±Ø©

        domtoimage.toPng(node, {
            width: node.offsetWidth * scale,
            height: node.offsetHeight * scale,
            style: {
                transform: 'scale(' + scale + ')',
                transformOrigin: 'top left',
                width: node.offsetWidth + 'px',
                height: node.offsetHeight + 'px'
            }
        })
        .then(function (dataUrl) {
            const link = document.createElement('a');
            link.download = `QR_ULTIMATE_${Date.now()}.png`;
            link.href = dataUrl;
            link.click();
        });
    }

    function rawDown(ext) { qrModel.download({ extension: ext }); }

    sync();
</script>

</body>
</html>
