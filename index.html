<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Elite Designer 2026 | النسخة الاحترافية</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        :root {
            --primary: #6366f1;
            --secondary: #a855f7;
            --bg: #0b0f1a;
            --card-bg: rgba(30, 41, 59, 0.6);
            --border: rgba(255, 255, 255, 0.1);
            --text-muted: #94a3b8;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg);
            background-image: 
                radial-gradient(circle at 10% 10%, rgba(99, 102, 241, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 90% 90%, rgba(168, 85, 247, 0.1) 0%, transparent 40%);
            color: white;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        /* Header */
        header {
            background: rgba(11, 15, 26, 0.8);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            padding: 1rem 8%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo { display: flex; align-items: center; gap: 12px; font-weight: 900; font-size: 1.5rem; }
        .logo-box { background: linear-gradient(135deg, var(--primary), var(--secondary)); padding: 5px 12px; border-radius: 12px; box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3); }

        /* Main Container */
        .main-wrapper {
            max-width: 1250px;
            margin: 40px auto;
            display: grid;
            grid-template-columns: 1.2fr 0.8fr;
            gap: 40px;
            padding: 0 20px;
        }

        @media (max-width: 1000px) { .main-wrapper { grid-template-columns: 1fr; } }

        /* Left Panel */
        .control-panel {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-radius: 35px;
            padding: 35px;
            border: 1px solid var(--border);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .section-tag {
            font-size: 0.8rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .section-tag::after { content: ''; flex: 1; height: 1px; background: var(--border); }

        .input-field {
            width: 100%;
            background: rgba(15, 23, 42, 0.8);
            border: 1.5px solid var(--border);
            border-radius: 18px;
            padding: 16px;
            color: white;
            font-family: 'Tajawal';
            margin-bottom: 25px;
            transition: 0.3s;
            box-sizing: border-box;
        }
        .input-field:focus { border-color: var(--primary); outline: none; background: #0f172a; }

        .flex-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px; }

        /* Frame Selector */
        .frame-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
        .frame-opt {
            background: rgba(255,255,255,0.03);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 15px;
            cursor: pointer;
            text-align: center;
            transition: 0.3s;
            font-size: 0.85rem;
        }
        .frame-opt:hover, .frame-opt.active { border-color: var(--primary); background: rgba(99, 102, 241, 0.1); transform: translateY(-2px); }

        /* Preview Side */
        .preview-side { position: sticky; top: 120px; text-align: center; }

        /* Capture Area (Where the magic happens) */
        .capture-container {
            background: white;
            padding: 40px;
            border-radius: 40px;
            display: inline-block;
            margin-bottom: 30px;
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            color: #0f172a;
            position: relative;
        }

        /* Frame Styles */
        .capture-container.f-phone { border: 12px solid #1e293b; border-radius: 60px; }
        .capture-container.f-bracket { border: 4px solid #6366f1; border-style: double; padding: 50px 70px; }
        .capture-container.f-modern { border-bottom: 15px solid #6366f1; border-radius: 20px; }

        .frame-msg { 
            display: none; 
            margin-top: 15px; 
            font-weight: 900; 
            font-size: 1.3rem; 
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Buttons */
        .btn-download {
            width: 100%;
            padding: 20px;
            border-radius: 20px;
            border: none;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            font-weight: 800;
            font-size: 1.2rem;
            cursor: pointer;
            font-family: 'Tajawal';
            transition: 0.3s;
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.4);
        }
        .btn-download:hover { transform: translateY(-4px); box-shadow: 0 15px 35px rgba(99, 102, 241, 0.5); }

    </style>
</head>
<body>

<header>
    <div class="logo">
        <div class="logo-box">QR</div>
        <span>ELITE DESIGNER</span>
    </div>
    <div style="color: var(--text-muted); font-size: 0.8rem;">نسخة عام 2026 الاحترافية</div>
</header>

<main class="main-wrapper">
    <div class="control-panel">
        <div class="section-tag">1. المحتوى الأساسي</div>
        <input type="text" id="qr-input" class="input-field" placeholder="ضع الرابط أو النص هنا..." oninput="updateQR()">

        <div class="section-tag">2. تخصيص الألوان (Gradient)</div>
        <div class="flex-row">
            <div>
                <label style="font-size: 0.8rem; display: block; margin-bottom: 10px;">اللون الأول</label>
                <input type="color" id="color1" value="#6366f1" oninput="updateQR()" style="width:100%; height:45px; border:none; border-radius:10px; cursor:pointer; background:none;">
            </div>
            <div>
                <label style="font-size: 0.8rem; display: block; margin-bottom: 10px;">اللون الثاني</label>
                <input type="color" id="color2" value="#a855f7" oninput="updateQR()" style="width:100%; height:45px; border:none; border-radius:10px; cursor:pointer; background:none;">
            </div>
        </div>

        <div class="section-tag">3. أنماط الإطارات (Frame Styles)</div>
        <div class="frame-grid">
            <div class="frame-opt active" onclick="applyFrame('none', this)">بدون إطار</div>
            <div class="frame-opt" onclick="applyFrame('f-phone', this, 'امسح للمزيد')">هاتف ذكي</div>
            <div class="frame-opt" onclick="applyFrame('f-bracket', this, 'SCAN ME')">أقواس فنية</div>
            <div class="frame-opt" onclick="applyFrame('f-modern', this, 'مرحباً بك')">مودرن</div>
        </div>

        <div class="section-tag" style="margin-top:30px">4. إضافة شعار مخصص</div>
        <input type="file" id="logo-file" accept="image/*" onchange="updateQR()" class="input-field" style="padding:10px; font-size:0.8rem;">
    </div>

    <div class="preview-side">
        <div id="capture-zone" class="capture-container">
            <div id="qr-canvas"></div>
            <div id="frame-text-display" class="frame-msg"></div>
        </div>

        <button class="btn-download" onclick="downloadAll()">تحميل التصميم الكامل (PNG)</button>
        <p style="margin-top:20px; color: var(--text-muted); font-size: 0.85rem;">يتم التحميل بجودة Ultra HD جاهزة للمطابع</p>
    </div>
</main>

<script>
    // 1. إعداد محرك الـ QR
    const qrStyling = new QRCodeStyling({
        width: 280,
        height: 280,
        data: "https://google.com",
        dotsOptions: {
            type: "extra-rounded",
            gradient: { type: "linear", rotation: 45, colorStops: [{ offset: 0, color: "#6366f1" }, { offset: 1, color: "#a855f7" }] }
        },
        backgroundOptions: { color: "transparent" },
        cornersSquareOptions: { type: "extra-rounded", color: "#6366f1" },
        imageOptions: { crossOrigin: "anonymous", margin: 10 }
    });

    qrStyling.append(document.getElementById("qr-canvas"));

    // 2. وظيفة تحديث الكود
    function updateQR() {
        const dataStr = document.getElementById("qr-input").value || " ";
        const c1 = document.getElementById("color1").value;
        const c2 = document.getElementById("color2").value;
        const file = document.getElementById("logo-file").files[0];

        let settings = {
            data: dataStr,
            dotsOptions: {
                gradient: { type: "linear", colorStops: [{ offset: 0, color: c1 }, { offset: 1, color: c2 }] }
            },
            cornersSquareOptions: { color: c1 },
            cornersDotOptions: { color: c2 }
        };

        if (file) {
            const reader = new FileReader();
            reader.onload = (e) => qrStyling.update({ ...settings, image: e.target.result });
            reader.readAsDataURL(file);
        } else {
            qrStyling.update(settings);
        }
    }

    // 3. وظيفة تطبيق الإطارات
    function applyFrame(className, element, label = "") {
        const zone = document.getElementById('capture-zone');
        const textTag = document.getElementById('frame-text-display');

        // تنظيف الكلاسات السابقة
        zone.className = 'capture-container';
        if(className !== 'none') zone.classList.add(className);

        // تحديث النص
        textTag.innerText = label;
        textTag.style.display = label ? "block" : "none";

        // تحديث حالة الأزرار
        document.querySelectorAll('.frame-opt').forEach(opt => opt.classList.remove('active'));
        element.classList.add('active');
    }

    // 4. السحر: تحميل الإطار مع الكود كصورة واحدة
    async function downloadAll() {
        const target = document.getElementById('capture-zone');
        
        // استخدام html2canvas لالتقاط المشهد بدقة عالية
        const canvas = await html2canvas(target, {
            scale: 3, // دقة 3x للطباعة
            backgroundColor: null,
            useCORS: true,
            logging: false
        });
        
        const link = document.createElement('a');
        link.download = 'Elite-QR-Premium.png';
        link.href = canvas.toDataURL("image/png");
        link.click();
    }
</script>

</body>
</html>
